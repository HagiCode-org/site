---
/**
 * 博客文章开头广告组件
 * 在博客文章标题之后、正文之前显示 GLM 推广卡片
 */
import { GLM_PROMO_LINKS } from '@shared/links';

interface Props {
  /** 是否隐藏广告 */
  hideAd?: boolean;
}

const { hideAd = false } = Astro.props;

// 如果设置隐藏广告，则不渲染
if (hideAd) {
  return null;
}

const { glmCoding } = GLM_PROMO_LINKS;
---

<div class="blog-header-ad">
  <div class="ad-icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z"/>
      <path d="m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z"/>
      <path d="M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0"/>
      <path d="M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5"/>
    </svg>
  </div>
  <div class="ad-content">
    <div class="ad-title">
      速来拼好模，智谱 GLM Coding 超值订阅
      <span class="ad-emphasis">（本项目同样使用智谱 AI 开发）</span>
    </div>
    <div class="ad-description">
      {glmCoding.description}立即开拼，享限时惊喜价！
    </div>
  </div>
  <a
    href={glmCoding.url}
    target="_blank"
    rel="noopener noreferrer"
    class="ad-button"
  >
    {glmCoding.label}
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M5 12h14"/>
      <path d="m12 5 7 7-7 7"/>
    </svg>
  </a>
</div>

<style>
  .blog-header-ad {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    margin-block-end: 1.5rem;
    border-radius: var(--sl-radius-md);
    background: linear-gradient(135deg,
      color-mix(in srgb, var(--color-primary) 8%, transparent),
      color-mix(in srgb, var(--color-secondary) 5%, transparent)
    );
    border: 1px solid color-mix(in srgb, var(--color-primary) 20%, var(--sl-color-gray-5));
  }

  .ad-icon {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: var(--sl-radius-sm);
    background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
    color: white;
  }

  .ad-content {
    flex: 1;
    min-width: 0;
  }

  .ad-title {
    font-weight: 600;
    color: var(--sl-color-text-high);
    margin-block-end: 0.25rem;
  }

  .ad-description {
    font-size: 0.875rem;
    color: var(--sl-color-text);
    line-height: 1.5;
  }

  .ad-emphasis {
    color: var(--color-primary);
    font-weight: 500;
  }

  .ad-button {
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 1rem;
    border-radius: var(--sl-radius-sm);
    background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
    color: white;
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .ad-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 128, 255, 0.25);
  }

  .ad-button svg {
    transition: transform 0.2s ease;
  }

  .ad-button:hover svg {
    transform: translateX(2px);
  }

  /* 响应式优化 */
  @media (max-width: 640px) {
    .blog-header-ad {
      flex-direction: column;
    }

    .ad-button {
      align-self: flex-start;
    }
  }

  /* 减少动画偏好 */
  @media (prefers-reduced-motion: reduce) {
    .ad-button,
    .ad-button svg {
      transition: none !important;
    }

    .ad-button:hover {
      transform: none;
    }

    .ad-button:hover svg {
      transform: none;
    }
  }
</style>
