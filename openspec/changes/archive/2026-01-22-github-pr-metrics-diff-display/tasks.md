## 1. 分析现有工作流

- [x] 1.1 阅读 `update-activity-metrics.yml` 了解当前实现
- [x] 1.2 分析 `data/activity-metrics.json` 数据结构
- [x] 1.3 确定需要对比的指标字段（dockerHub.pullCount、clarity.activeUsers、clarity.activeSessions）

## 2. 修改 update-activity-metrics.yml 工作流

- [x] 2.1 在运行 `npm run update-metrics` 之后，保存旧的指标数据
- [x] 2.2 添加读取 main 分支旧数据的步骤
- [x] 2.3 添加计算差值和变化百分比的逻辑
- [x] 2.4 修改 PR 描述模板，包含对比表格

## 3. 实现指标对比逻辑

- [x] 3.1 使用 jq 读取新指标数据
- [x] 3.2 使用 git show 读取旧指标数据（main 分支）
- [x] 3.3 计算绝对差值（新值 - 旧值）
- [x] 3.4 计算变化百分比（(新值 - 旧值) / 旧值 * 100）
- [x] 3.5 处理首次运行场景（无旧数据时跳过对比）

## 4. 增强 PR 描述格式

- [x] 4.1 设计对比表格格式（指标 | 原值 | 新值 | 变化）
- [x] 4.2 实现视觉区分（增长用 ↑▲，下降用 ↓▼）
- [x] 4.3 添加摘要统计（总变化数、增长数、下降数）
- [x] 4.4 更新 PR body 模板变量

## 5. 测试和验证

- [x] 5.1 手动触发 workflow 验证功能
- [x] 5.2 验证首次运行（无旧数据）的降级处理
- [x] 5.3 验证有旧数据时的对比计算准确性
- [x] 5.4 验证 PR 描述格式正确显示
- [x] 5.5 验证箭头和百分比格式正确

## 6. 文档更新

- [x] 6.1 更新 workflow 文件内的注释说明
- [x] 6.2 记录修改内容到 CHANGELOG（如有）
