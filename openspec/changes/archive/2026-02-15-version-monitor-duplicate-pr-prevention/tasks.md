# Implementation Tasks

## 1. 准备工作
- [ ] 1.1 阅读并理解提案内容
- [ ] 1.2 查看当前 `version-monitor.yml` 工作流文件
- [ ] 1.3 测试 GitHub CLI 查询 PR 命令格式

## 2. 添加 PR 存在性检查
- [ ] 2.1 在 "Create Pull Request" 步骤前添加新步骤 "Check Existing PR"
- [ ] 2.2 实现使用 `gh pr list` 查询现有 PR 的逻辑
- [ ] 2.3 解析查询结果，设置输出变量 `pr_exists`
- [ ] 2.4 添加条件判断，仅在 PR 不存在时执行创建步骤

## 3. 优化分支管理
- [ ] 3.1 在 "Create feature branch" 步骤前添加检查远程分支的逻辑
- [ ] 3.2 设置输出变量 `branch_exists`
- [ ] 3.3 修改分支创建步骤，仅在分支不存在时执行
- [ ] 3.4 调整 "Delete remote branch if exists" 步骤的逻辑

## 4. 改进关闭旧 PR 逻辑
- [ ] 4.1 修改 "Close previous version PRs" 步骤的搜索查询
- [ ] 4.2 添加排除当前版本的逻辑
- [ ] 4.3 确保不会意外关闭刚创建的 PR

## 5. 完善日志输出
- [ ] 5.1 在 PR 检查步骤中添加详细的日志输出
- [ ] 5.2 在分支检查步骤中添加详细的日志输出
- [ ] 5.3 更新 "Display result" 步骤包含新的状态信息

## 6. 测试验证
- [ ] 6.1 手动触发工作流测试 PR 检查逻辑
- [ ] 6.2 验证当 PR 已存在时不会重复创建
- [ ] 6.3 验证当有真正新版本时能正常创建 PR
- [ ] 6.4 验证旧 PR 关闭逻辑正确工作

## 7. 文档更新
- [ ] 7.1 更新工作流注释说明新的检查逻辑
- [ ] 7.2 添加维护说明文档

## 实施顺序

按顺序完成以下阶段：

**阶段 1：准备** → 任务 1.1-1.3

**阶段 2：核心功能** → 任务 2.1-2.4、4.1-4.3

**阶段 3：分支优化** → 任务 3.1-3.4

**阶段 4：完善** → 任务 5.1-5.3、6.1-6.4、7.1-7.2
